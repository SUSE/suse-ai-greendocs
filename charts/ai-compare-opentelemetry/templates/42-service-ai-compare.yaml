apiVersion: v1
kind: Service
metadata:
  name: {{ include "ai-compare-opentelemetry.fullname" . }}-app-service
  labels:
    app.kubernetes.io/name: {{ include "ai-compare-opentelemetry.name" . }}
    app.kubernetes.io/instance: {{ .Release.Name }}
    app.kubernetes.io/component: genai-chat
    app.kubernetes.io/part-of: genai-stack
    ai.framework: "gradio-ollama"
    genai.application: "true"
    genai.app: "true"
  annotations:
    genai.observability/enabled: "true"
    genai.observability/type: "chat-application"
    genai.observability/models: "llama3.2:latest"
    genai.observability/framework: "ollama"
    observability.suse.com/genai-app: "true"
    ai.application.category: "conversational-ai"
spec:
  selector:
    app: {{ include "ai-compare-opentelemetry.fullname" . }}-app
  ports:
  - protocol: TCP
    port: {{ .Values.aiCompare.service.port }}
    targetPort: {{ .Values.aiCompare.service.port }}
    name: gradio
{{- if and (eq .Values.aiCompare.service.type "NodePort") .Values.aiCompare.service.nodePort }}
    nodePort: {{ .Values.aiCompare.service.nodePort }}
{{- end }}
  - protocol: TCP
    port: {{ .Values.aiCompare.httpApi.port }}
    targetPort: {{ .Values.aiCompare.httpApi.port }}
    name: http-api
{{- if and (eq .Values.aiCompare.service.type "NodePort") .Values.aiCompare.service.httpApiNodePort }}
    nodePort: {{ .Values.aiCompare.service.httpApiNodePort }}
{{- end }}
  type: {{ .Values.aiCompare.service.type }}
